<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapitre 1 | Compte Rendu Opératoire</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="icon.ico">
</head>
    <body class="grosse">
        <main id="grosse-boite">
            <h3 class='retour'><a href="sommaire.html?skip=true">< Retour au sommaire</a></h3>
            <h1 id="blocage-de-lacc%C3%A8s-de-ladministrateur-%C3%A0-loutil-de-conception-du-site-web">Blocage de l'accès de l'administrateur à l'outil de conception du site web</h1>
            <hr>
            <p>À l'adresse <code>192.168.19.128/secret</code> se trouve un site secret WordPress.</p>
            <p><img src="screens/V_1.png" alt="V_1"></p>
            <p>Pour acceder au panel d'administration du site, il faut cliquer sur <code>Log in</code> en bas du menu de droite.</p>
            <p><img src="screens/V_2.png" alt="V_2"></p>
            <p>Il faut connaitre le mot de passe ainsi que le nom d'utilisateur du compte pour se connecter</p>
            <p>Après avoir utiliser plusieurs combinaisons connues nous avons découvert que admin/admin fonctionne. Cependant, surement à cause d'une faute de frappe nous ne l'avions pas découvert sur le coup.<br>
            Nous avons donc du agir différement.</p>
            <p>WordPress utilise MySQL comme outil de base de données et certaines informations très importantes se trouvent dans le fichier <code>/var/www/html/secret/wp-config.php</code> :</p>
            <pre class="hljs"><code>cat /var/www/html/secret/wp-config.php</code></pre>
            <p><img src="screens/V_3.png" alt="V_3"></p>
            <p>On retrouve ici dans l'ordre :</p>
            <ul>
            <li>Le nom de la base de données</li>
            <li>Le nom de l'utilisateur de cette base de données</li>
            <li>Le mot de passe de l'utilisateur de cette base de données</li>
            </ul>
            <p>Il suffit maintenant de se connecter à cette base de données et de rentrer le mot de passe :</p>
            <pre class="hljs"><code>mysql -p -u root wp_myblog</code></pre>
            <table>
            <thead>
            <tr>
            <th>Paramètre</th>
            <th>Explication</th>
            </tr>
            </thead>
            <tbody>
            <tr>
            <td>-p</td>
            <td>Utilisation d'un mot de passe</td>
            </tr>
            <tr>
            <td>-u root</td>
            <td>Utilisation d'un compte utilisateur précis (ici root)</td>
            </tr>
            <tr>
            <td>wp_myblog</td>
            <td>Le nom de la base</td>
            </tr>
            </tbody>
            </table>
            <p><img src="screens/V_4.png" alt="V_4"></p>
            <p>On cherche maintenant à trouver où se trouve le mot de passe du panel d'administration. Pour afficher les tables disponnibles :</p>
            <pre class="hljs"><code>SHOW TABLES;</code></pre>
            <p><img src="screens/V_5.png" alt="V_5"></p>
            <p>La table <code>wp_users</code> à l'air de nous interesser, pour afficher son contenu :</p>
            <pre class="hljs"><code>SELECT * FROM wp_users;</code></pre>
            <p><img src="screens/V_6.png" alt="V_6"></p>
            <p>Bingo, on retrouve notre login ainsi que le hash du mot de passe que l'on souhaite avoir. Comme il serait trop long de le bruteforce, nous allons directement changer le mot de passe à l'interieur de la base.</p>
            <p>Le <code>$P$</code> devant le hash nous donne le type de hashage qui est utilisé. C'est un format qui est utilisé par WordPress.</p>
            <p>Sur Google, nous avons trouvé un outil permettant de réaliser le même type de hashage :</p>
            <p><img src="screens/V_7.png" alt="V_7"><br>
            <em>On retrouve bien le <code>$P$</code> devant notre hash</em></p>
            <p>Le nouveau mot de passe sera <code>johnny</code>.<br>
            Pour le faire appliquer dans la base :</p>
            <pre class="hljs"><code>UPDATE `wp_users` SET `user_pass` = '$P$B.kCJG3VQye54jw32qoy2CaBBczIgm.' WHERE user_login = 'admin';</code></pre>
            <p><img src="screens/V_8.png" alt="V_8"></p>
            <p>Le voilà changé, allons voir si cela fonctionne sur le site :</p>
            <p><img src="screens/V_9.png" alt="V_9">
            <img src="screens/V_10.png" alt="V_10"></p>
            <p>Le tour est joué, nous arrivons maintenant à nous connecter grâce au couple admin/johnny et l'administrateur ne peux plus se connecter avec l'ancien mot de passe !</p>
            <menu>
                <p><a href="chap4.html">< Chapitre 4</a></p>
                <p><a href="sommaire.html?skip=true">Retour au sommaire ></a></p>
            </menu>
        </main>
    </body>
</html>