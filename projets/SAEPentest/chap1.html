<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapitre 1 | Compte Rendu Opératoire</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="icon.ico">
</head>
    <body class="grosse">
        <main id="grosse-boite">
            <h3 class='retour'><a href="sommaire.html?skip=true">< Retour au sommaire</a></h3>
            <h1 id="acc%C3%A8s-aux-fichiers-du-syst%C3%A8me-dexploitation">Accès aux fichiers du système d'exploitation</h1>
            <hr>
            <p>Pour commencer, nous devons chercher quels services (et leurs versions) ont des ports ouverts sur la Machine Virtuelle.<br>
            Pour ce faire, il suffit d'utiliser l'outil <code>Nmap</code> avec l'adresse IP de la VM.</p>
            <pre class="hljs"><code>nmap 192.168.19.128 -vv -sV -oN &quot;nmapsV&quot;</code></pre>
            <table>
            <thead>
            <tr>
            <th>Paramètre</th>
            <th>Explication</th>
            </tr>
            </thead>
            <tbody>
            <tr>
            <td>-vv</td>
            <td>Mode Verbose</td>
            </tr>
            <tr>
            <td>-sV</td>
            <td>Recherche de la version des services</td>
            </tr>
            <tr>
            <td>-oN</td>
            <td>Mettre le résultat de la commande dans un fichier</td>
            </tr>
            </tbody>
            </table>
            <p>Voici le résultat de cette commande :</p>
            <p><img src="screens/nmapsv.png" alt="Nmap Versions Services"></p>
            <hr>
            <p>Grâce à ces versions, nous pouvons utiliser Metasploit pour trouver une exploit à utiliser.<br>
            Nous allons essayer de pénétrer la machine grâce au service <code>ProFTPD 1.3.3c</code>.
            La recherche dans Metasploit ce fait grâce à la commande <code>search</code>.</p>
            <pre class="hljs"><code>search ProFTPD 1.3.3c</code></pre>
            <p>Voici le résultat de cette commande :</p>
            <p><img src="screens/metasploit_search.png" alt="Metasploit Search"></p>
            <p>On trouve une seule exploit.<br>
            Pour l'utiliser, on utilise la commande :</p>
            <pre class="hljs"><code>run 0</code></pre>
            <p>La commande <strong>info</strong> nous montre les différentes options a renseigner pour utiliser l'exploit :</p>
            <p><img src="screens/metasploit_info.png" alt="Metasploit Info"></p>
            <table>
            <thead>
            <tr>
            <th>Paramètre</th>
            <th>Explication</th>
            </tr>
            </thead>
            <tbody>
            <tr>
            <td>RHOSTS</td>
            <td>Remote Host, l'adresse IP de la cible</td>
            </tr>
            <tr>
            <td>RPORT</td>
            <td>Remote Port, le port du socket TCP</td>
            </tr>
            <tr>
            <td>LHOST</td>
            <td>Local Host, l'adresse IP de l'attaquant (Non indiqué au dessus)</td>
            </tr>
            </tbody>
            </table>
            <p>Pour renseigner l'option qui nous interresse, il suffit de taper :</p>
            <pre class="hljs"><code>set RHOSTS @IPDest</code></pre>
            <p>Pour que l'exploit soit utilisable, nous devons choisir un payload.
            Pour voir la liste des payloads, on utilise la commande</p>
            <pre class="hljs"><code>show payloads</code></pre>
            <p><img src="screens/metasploit_payloads.png" alt="Metasploit Payloads"></p>
            <p>Vous pouvez prendre celui que vous voulez, dans notre cas nous avons pris le 4ème :</p>
            <pre class="hljs"><code>set payload 3</code></pre>
            <p>Notre exploit est maintenant utilisable, il suffit maintenant de le lancer :</p>
            <pre class="hljs"><code>run</code></pre>
            <p><img src="screens/metasploit_run.png" alt="Metasploit Run"></p>
            <p>Nous voilà connecté en tant que root sur la VM du client.</p><br>
            
Le promp n'est pas affiché mais nous sommes dans un terminal de commande classique. Nous pouvons maintenant nous balader dans les fichiers de la machine avec les commandes de base de Linux (<code>ls</code>, <code>cd</code>,...).</p>
            <menu>
                <p><a href="sommaire.html?skip=true">< Sommaire</a></p>
                <p><a href="chap2.html">Chapitre 2 ></a></p>
            </menu>
        </main>
    </body>
</html>